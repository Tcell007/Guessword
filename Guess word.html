<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>เกมทายศัพท์ | Input & Display</title>
  <style>
    body { margin: 0; background: #0f172a; color: #e5e7eb; font-family: system-ui, -apple-system, "Noto Sans Thai", sans-serif; display: grid; place-items: start center; padding: 24px; }
    .app { width: min(1100px, 95vw); }
    .tabs { display: flex; gap: 8px; margin-bottom: 16px; }
    .tab-btn { padding: 10px 14px; border: 1px solid #334155; background: #1e293b; color: #e5e7eb; border-radius: 14px; cursor: pointer; }
    .tab-btn[aria-selected="true"] { background: #0e1627; border-color: #22314a; }
    .card { background: #111827; border: 1px solid #1f2937; border-radius: 18px; padding: 18px; }
    textarea, input[type="text"], input[type="password"] { width: 100%; background: #0a0f1c; color: #e5e7eb; border: 1px solid #334155; border-radius: 12px; padding: 12px 14px; outline: none; font-size: 15px; }
    .btn { padding: 10px 14px; border: 1px solid #243146; background: #1e293b; color: #e5e7eb; border-radius: 12px; cursor: pointer; }
    .grid { display: flex; gap: 10px; flex-wrap: wrap; }
    .group-block { border: 1px dashed #334155; border-radius: 14px; padding: 10px; margin-bottom: 12px; background: rgba(15,23,42,.35); }
    .group-title { font-weight: bold; margin-bottom: 6px; }
    .word-wrap { position: relative; display: inline-block; padding: 8px 12px; border: 1px dashed #334155; border-radius: 14px; margin: 4px; background: rgba(15,23,42,.35); }
    .word { position: relative; z-index: 1; font-weight: 600; }
    .cover { position: absolute; inset: 0; border-radius: 12px; opacity: .98; transition: opacity .35s ease; z-index: 2; }
    .cover.revealed { opacity: 0; pointer-events: none; }
    .badges { display: flex; flex-wrap: wrap; gap: 8px; }
    .badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 999px; background: #1a2438; border: 1px solid #2a3a58; font-size: 14px; cursor: pointer; }
    .hidden { display: none !important; }
    .counters { margin-top: 10px; font-size: 14px; color: #9ca3af; }
  </style>
</head>
<body>
  <div class="app">
    <div class="tabs">
      <button class="tab-btn" id="tab-input" aria-selected="true">Input</button>
      <button class="tab-btn" id="tab-display" aria-selected="false">Display</button>
    </div>

    <section id="panel-input" class="card">
      <h3>ป้อนคำศัพท์</h3>
      <p>พิมพ์คำในแต่ละบรรทัด โดยบรรทัดหนึ่งถือเป็น <b>หนึ่งกลุ่ม</b> คำภายในกลุ่มคั่นด้วยคอมมา(,)</p>
      <textarea id="input-words" rows="8" placeholder="เช่น: apple, sky, mango\ntrain, river, cloud"></textarea>
      <div style="margin-top: 10px; text-align: right;">
        <button id="btn-generate" class="btn">สร้างกล่องคำ</button>
      </div>
    </section>

    <section id="panel-display" class="card hidden">
      <h3>ป้ายกลุ่มคำศัพท์</h3>
      <div id="words-container"></div>
      <div class="counters">เปิดแล้ว: <span id="opened-count">0</span> / <span id="total-count">0</span></div>
      <div style="margin: 12px 0;">
        <input id="guess-input" type="text" placeholder="พิมพ์คำเพื่อทาย" />
        <button id="btn-check" class="btn">Check</button>
        <button id="btn-reveal-all" class="btn">Reveal All</button>
        <button id="btn-reset" class="btn">Reset Cover</button>
      </div>
      <h4>คำที่ไม่อยู่ในป้าย (คลิกลบได้)</h4>
      <div id="wrong-list" class="badges"></div>
    </section>

    <section id="panel-pass" class="card hidden">
      <h3>ใส่รหัสเพื่อเข้าถึง Input : no</h3>
      <input id="pass-input" type="password" placeholder="Enter password" />
      <div style="margin-top:10px; text-align:right;">
        <button id="btn-pass" class="btn">Unlock</button>
      </div>
    </section>
  </div>

  <script>
    const state = { groups: [], normWords: new Set(), revealed: new Set(), locked:true, password:"no" };

    function normalize(str){ return (str||"").trim().toLowerCase(); }
    function parseGroups(text){
      const lines=text.split(/\n+/).map(l=>l.trim()).filter(Boolean);
      return lines.map(line=>line.split(/[,]+/).map(w=>w.trim()).filter(Boolean));
    }
    function pastel(){
      const h=Math.floor(Math.random()*360);
      const s=70+Math.floor(Math.random()*20);
      const l=75+Math.floor(Math.random()*10);
      return `hsl(${h} ${s}% ${l}%)`;
    }

    const tabInput=document.getElementById('tab-input');
    const tabDisplay=document.getElementById('tab-display');
    const panelInput=document.getElementById('panel-input');
    const panelDisplay=document.getElementById('panel-display');
    const panelPass=document.getElementById('panel-pass');

    function setTab(which){
      if(which==='input'){
        if(state.locked){
          tabInput.setAttribute('aria-selected',true);
          tabDisplay.setAttribute('aria-selected',false);
          panelInput.classList.add('hidden');
          panelDisplay.classList.add('hidden');
          panelPass.classList.remove('hidden');
          return;
        }
        tabInput.setAttribute('aria-selected',true);
        tabDisplay.setAttribute('aria-selected',false);
        panelInput.classList.remove('hidden');
        panelDisplay.classList.add('hidden');
        panelPass.classList.add('hidden');
      } else {
        tabInput.setAttribute('aria-selected',false);
        tabDisplay.setAttribute('aria-selected',true);
        panelInput.classList.add('hidden');
        panelDisplay.classList.remove('hidden');
        panelPass.classList.add('hidden');
      }
    }

    tabInput.onclick=()=>setTab('input');
    tabDisplay.onclick=()=>setTab('display');

    const inputArea=document.getElementById('input-words');
    const btnGenerate=document.getElementById('btn-generate');
    const wordsContainer=document.getElementById('words-container');
    const wrongList=document.getElementById('wrong-list');
    const openedCount=document.getElementById('opened-count');
    const totalCount=document.getElementById('total-count');

    function buildDisplay(){
      wordsContainer.innerHTML=''; wrongList.innerHTML=''; state.normWords.clear(); state.revealed.clear();
      state.groups.forEach((group,gi)=>{
        const block=document.createElement('div'); block.className='group-block';
        const title=document.createElement('div'); title.className='group-title'; title.textContent=`คำศัพท์กลุ่ม ${gi+1}`;
        block.appendChild(title);
        group.forEach(word=>{
          const wrap=document.createElement('div'); wrap.className='word-wrap';
          const t=document.createElement('span'); t.className='word'; t.textContent=word;
          const cover=document.createElement('span'); cover.className='cover'; cover.dataset.word=normalize(word); cover.style.background=pastel();
          wrap.appendChild(t); wrap.appendChild(cover); block.appendChild(wrap);
          state.normWords.add(normalize(word));
        });
        wordsContainer.appendChild(block);
      });
      totalCount.textContent=state.normWords.size; openedCount.textContent=0;
    }

    btnGenerate.onclick=()=>{ state.groups=parseGroups(inputArea.value); buildDisplay(); state.locked=true; setTab('display'); };

    const guessInput=document.getElementById('guess-input');
    document.getElementById('btn-check').onclick=()=>{
      const raw=guessInput.value; const norm=normalize(raw); if(!norm) return;
      let found=false;
      document.querySelectorAll('.cover:not(.revealed)').forEach(el=>{ if(el.dataset.word===norm){ el.classList.add('revealed'); state.revealed.add(norm); found=true; }});
      if(found) openedCount.textContent=state.revealed.size; else addWrongBadge(raw.trim());
      guessInput.value='';
    };
    function addWrongBadge(text){ const b=document.createElement('span'); b.className='badge'; b.textContent=text; b.onclick=()=>b.remove(); wrongList.appendChild(b); }
    document.getElementById('btn-reveal-all').onclick=()=>{ document.querySelectorAll('.cover').forEach(el=>el.classList.add('revealed')); state.revealed=new Set(state.normWords); openedCount.textContent=state.revealed.size; };
    document.getElementById('btn-reset').onclick=()=>{ document.querySelectorAll('.cover').forEach(el=>el.classList.remove('revealed')); state.revealed.clear(); wrongList.innerHTML=''; openedCount.textContent=0; };

    document.getElementById('btn-pass').onclick=()=>{
      const val=document.getElementById('pass-input').value;
      if(val===state.password){ state.locked=false; setTab('input'); }
      else alert('รหัสไม่ถูกต้อง');
    };

    inputArea.value="apple, Banana, mango\ntrain, River, cloud\nSky, ocean";
  </script>
</body>
</html>
